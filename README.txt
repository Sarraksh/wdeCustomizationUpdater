Общее описание

Утилита WDE Customisation Updater предназначена для упрощения и ускорения процесса
добавления, обновления или удаления кастомизаций WDE через Click Once,
исключения ряда возможных ошибок при обновлении кастомизаций из под разных учётных записей Windows
или при поддержке большого количества кастомизаций, при тестировании и выявлении сбойной кастомизации,
а также создания и хранения истории изменений кастомизаций.


Установка

В любой директории, на которую имеются права на запись, создать папку (например "C:\GCTI\DesktopApplications\Updater")
и поместить в неё файлы "wdeCustomizationUpdater_x.x.x.x.exe" (где x.x.x.x номер версии) и "config.yaml".
В файле конфигурации требуется указать  директорию установки WDE и директорию хранения файлов кастормизаций.
Пример содержимого файла config.yaml (форматирование YAML)
==============
CustomizationsFolder: C:\GCTI\DesktopApplications\WDE_Custom_Files #each customization must be in it's own subfolder
WDEFolder: C:\GCTI\DesktopApplications\WorkspaceDesktopEdition
==============


Использование

# В папку, указанную в опции "CustomizationsFolder", требуется поместить файлы кастомизаций так,
  чтобы каждая кастомизация находилась внутри отдельной подпапки,
  а также сохранялась структура подпапок самого WDE (таких как Languages).
  Пример структуры папок
==============
C:\GCTI\DesktopApplications\WDE_Custom_Files\
    Com.Chat.History.1.0.0.1\
        Com.Chat.History.dll
        Com.Chat.History.module-config
    Com.Vk.1.0.2.0\
        AdornedControl.dll
        Com.Vk.dll
        Com.Vk.dll.config
        Com.Vk.module-config
        FontAwesome.WPF.dll
        Languages\
            Com.Vk.en-US.xml
            Com.Vk.ru-RU.xml
==============
# Запустить утилиту
  В этот момент происходит сбор данных и копирование отобранных файлов кастомизаций
# Дождаться запуска WDE Deployment Manager
  (при этом основное окно утилиты не будет закрыто)
# На этапе добавления файлов кастомизаций будет автоматически сформирован список всех файлов кастомизаций,
  находящихся в папках C:\GCTI\DesktopApplications\WDE_Custom_Files\*\
  (файлы, находящиеся непосредственно в C:\GCTI\DesktopApplications\WDE_Custom_Files\ игнорируются)
# Провести настройки, возможные только в ручном режиме
  (например назначение новым файлам кастомизаций GroupName,
  изменение хост/порт config сервера или аппликации WDE)
# Завершить работу мастера в стандартном режиме.


Особенности утилиты

Утилита запускается как обычный исполняемый файл любым удобным способом.

В случае, если у клиента ещё не разворачивался Click Once первый запуск можно проводить под любым пользователем Windows.
Если у клиента уже развёрнуто WDE через Click Once, лучше всего проводить первый запуск из под пользователя,
из под которого последний раз успешно разворачивалось приложение.

При сборке часть файлов (на данный момент readme, .pdb и .md) исключаются из общего списка файлов.
Также, при наличии в разных кастомизациях файлов с одинаковым названием (например Com.Altuera.Genesys.WdeCustomLogger.dll),
утилита выбирает самый новый (по версии в свойствах файла или по дате последнего изменения) и добавляет только его.

Поскольку все настройки WDE Deployment Manager хранит в реестре локального пользователя,
утилита сохраняет данные настройки в файл и переиспользует вне зависимости от того из под кого она запускается повторно.
Это позволяет исключить ситуации при которых новая опция может быть потеряна при последующих обновлениях.
Эти данные хранятся в директории программы в подпапке "Rgistry".
При каждом запуске создаётся новый файл с датой и временем в названии.
В целях резервирования сохраняются последние 5 файлов.
Данные хранятся в виде набора сущностей ключ/значение в формате YAML.

При каждом запуске также создаётся исторический файл, который содержит список всех просканированных подпапок и
найденных файлов. Также  по каждому файлу указан статус.
[REDUNDANT] - запрещённый файл, не включён в сборку.
[SKIP     ] - файл пропущен, поскольку является более старым или аналогичным.
[COPIED   ] - файл скопирован в папку WDE.

С помощью утилиты можно быстро добавлять, изменять и удалять кастомизации для WDE.